# 网络编程基础

## 互联网 TCP / IP

为了使计算机联网，就必须规定通信协议。早期的计算机网络，都由各厂商自己规定一套协议，如IBM、Apple和Microsoft都有各自的网络协议，互不兼容。这就好比一群人，有的说英语，有的说法语，有的说德语，说同一种语言的人可以交流，说不同语言的人相互之间就无法交流。

为了把全世界的所有不同类型的计算机都连接起来，就必须规定一套全球通用的协议，因此，国际标准化组织制定了OSI七层模型互联网协议标准，如图所示。虽然互联网协议包含了上百种协议标准，但是其中最重要的两个协议是TCP和IP，因此，人们把互联网的协议简称为TCP/IP。

![](Resources/00.png)

## IP

在通信时，通信双方必须知道对方的标识，如同用户发邮件时必须知道对方的邮件地址一样。**互联网上每台计算机的唯一标识就是IP地址**，如202.196.32.7。如果一台计算机同时接入两个或更多的网络，如路由器，那么它就会有两个或多个IP地址。因此，**IP地址对应的实际上是计算机的网络接口，通常是网卡。**

IP负责把数据从一台计算机通过网络发送到另一台计算机。数据被分割成一小块一小块，然后通过IP包发送出去。由于互联网链路复杂，两台计算机之间经常有多条线路，因此，**路由器就负责决定如何把一个IP包转发出去。**

**IP包的特点是按块发送，途径多个路由，但不保证能到达，也不保证顺序到达。**

IPv4版的IP地址实际上是一个32位整数，以字符串表示的IP地址如192.168.0.1实际上是把32位整数按8位分组后的数字表示，目的是便于阅读。

IPv6版的IP地址实际上是一个128位整数，它是目前使用的IPv4的升级版，以字符串表示类似于2001:0db8:85a3:0042:1000:8a2e:0370:7334。

## TCP 和 UDP

### TCP

> TCP是建立在IP之上，是面向 **<font color="orange">有连接</font>** 的通信协议。
>
> TCP负责在两台计算机之间建立 **<font color="orange">可靠连接</font>**，保证数据包按**<font color="orange">顺序到达</font>**。
>
> TCP通过握手建立连接，然后，对每个IP包编号，确保对方按顺序收到，如果包丢失，就自动重发。

许多常用的更高级的协议都是建立在TCP基础上的，如用于浏览器的HTTP、发送邮件的SMTP等。

### UDP

> UDP，同样是建立在IP之上，但它是面向 **<font color="orange">无连接的通信协议</font>**。
>
> UDP **<font color="orange">不能保证数据包的顺利到达</font>**，是 **<font color="orange">不可靠传输</font>**，但 **<font color="orange">传输效率比TCP高</font>**。

## 端口

一个IP包除了包含要传输的数据外，还包含源IP地址和目标IP地址、源端口和目标端口。

### 端口的作用

在两台计算机进行通信时，只发IP地址是不够的，因为同一台计算机上还运行着多个网络程序（如浏览器、QQ等网络程序）。一个IP包到来之后，到底是交给浏览器还是QQ，就需要通过端口号来进行区分。

每个网络程序都向操作系统申请唯一的端口号，这样，两个进程在两台计算机之间建立网络连接就需要各自的IP地址和各自的端口号。例如，浏览器常常使用80端口，FTP程序使用21端口，邮件收发使用25端口。

网络上两个计算机之间的数据通信，归根结底就是不同主机的进程交互，而每个主机的进程都对应着某个端口。也就是说，单独靠IP地址是无法完成通信的，必须要有IP和端口

## Socket 套接字

Socket（套接字）是网络编程的一个抽象概念，主要用于网络通信编程。

20世纪80年代初，美国政府的高级研究工程机构（ARPA）给加利福尼亚大学Berkeley分校提供了资金，让他们在UNIX操作系统下实现TCP/IP。在这个项目中，研究人员为TCP/IP网络通信开发了一个API（应用程序接口），这个API称为socket（套接字）。

socket是TCP/IP网络最为通用的API。任何网络通信都是通过socket来完成的。

通常用一个socket表示“打开了一个网络链接”，而打开一个网络链接只需知道目标计算机的IP地址和端口号，再指定协议类型即可。

### 套接字构造函数

- **<font color="orange"> socket（family,type[,protocal]） </font>**

  它使用给定的套接字家族、套接字类型、协议编号来创建套接字。

  - 参数说明：
    - **family : 套接字家族，可以是 AF_UNIX 或者 AF_INET、AF_INET6.</font>**
    - **type：套接字类型，可以根据是面向连接的还是非连接分为 SOCK_STREAM 或 SOCK_DGRAM.**
    - **protocol : 协议，一般不填，默认为 0.**

- 参数取值含义如下表：

  

| 参数 | 描述 |
| :--: | :--: |
|      |      |
|      |      |
|      |      |
|      |      |
|      |      |
|      |      |
|      |      |

