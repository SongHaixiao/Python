# 删除列表中重复元素并保持顺序不变

在Python程序中，可以删除列表中重复出现的元素，并且保持剩下元素的显示顺序不变。

### 可散列的情况

如果序列中保存的元素是可散列的（hashable），那么上述功能可以使用集合和生成器实现。

例如，下面的文件delshun.py演示了在可散列情况下的实现过程

```python
# delshun.py
def dedupe(items):
    seen = set()        # set - 不可重复
    for item in items:
        if item not in seen:
            yield item
            seen.add(item)

if __name__ == '__main__':
    a = [5,5,2,1,9,1,5,10]
    print(a)
    print(list(dedupe(a)))
```

如果一个对象是可散列的，那么在它的生存周期内是不可变的，这需要一个 \_\_hash\_\_() 方法.

在 Python 程序中，整数、浮点数、字符串和元组都是不可变的。

在上述代码中，函数 dedupe() 实现了可散列情况下的删除重复元素功能，并且保持剩下元素的显示顺序不变。

```
output : 

[5, 5, 2, 1, 9, 1, 5, 10]
[5, 2, 1, 9, 10]
```

### 不可散列的情况

上述实例文件 delshun.py 有一个缺陷，只有当序列中的元素是可散列的时候才能这么做。

下面的例子在不可散列的对象序列中去除重复项，并保持顺序不变。

```python
# buha.py
def buha(items,key = None):
    seen = set()
    for item in items:
        val = item if key is None else key (item)

        if val not in seen:
            yield item
            seen.add(val)

if __name__ == '__main__':
    a =  [
        {'x' : 2, 'y' : 3},
        {'x' : 2, 'y' : 4},
        {'x' : 2, 'y' : 3},
        {'x' : 2, 'y' : 3},
        {'x' : 10, 'y' : 15}
    ]

    print(a)
```

在上述代码中，函数 buha() 中的参数 key 的功能是将序列中的元素转换为可散列的类型，这样做的目的是检测重复选项。

```
output:

[{'x': 2, 'y': 3}, {'x': 2, 'y': 4}, {'x': 2, 'y': 3}, {'x': 2, 'y': 3}, {'x': 10, 'y': 15}]

```

- 函数调用的两个示例：
  
  1. 本例子中的匿名函数(即"解构函数")表示的含义是以 (x,y) 这个整体为主键,去除 a 中与之重复( x 与 y 的值都相同)的元素. 即 重复的 {'x' : 2, 'y' : 3} 被去除。 

    ```python
    print(list(buha(a, key = lambda a:(a['x'],a['y']))))
    ```

    ```
    output:

    [{'x': 2, 'y': 3}, {'x': 2, 'y': 4}, {'x': 10, 'y': 15}]
    ```

  2. 本例中的匿名函数（即"解构函数") 以 x 为主键,去除 a 中与之重复(x的值相同)的元素.
     即， 重复包含重复 x 的 {'x': 2, 'y': 4}, 第 二 个 {'x': 2, 'y': 3}, 第三个 {'x': 2, 'y': 3} 被去除.
    
    ```python
    print(list(buha(a, key=lambda d: d['x'])))
    ```

    ```
    output:

    [{'x': 2, 'y': 3}, {'x': 10, 'y': 15}]
    ```

    - 这里用lambda写解构函数很方便，值得学习。

    - 另外注意一下此处的 list （代码中dedupe外面的那一个），可以直接把generator转换为list，使用起来很方便。