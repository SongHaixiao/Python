# 使用列表推导式

在 Python 中，列表推导式（List Comprehension) 是一种简化代码的优美方法。

Python 官方文档描述到：列表推导式提供了一种创建列表的简洁方法。

使用列表推导式能够非常简洁地构造一个新列表，只需要用一个简洁表达式即可对得到的元素进行转换变形。

### 语法

```python
# List Comprehension Format
variable = [out_expres for out_express in input_list if condition_expres]
```

- out_express : 列表生成元素表达式，可以是有返回值得函数
- for out_express in input_list ：迭代 input_list, 将 out_express 传入 out_express 表达式中.
- condition_express : 判断根据条件可以过滤哪些值。

### 例子

1. 创建一个包含从 1 到 10的平方的列表

   ```python
   # Way 1 : 传统方法
   squares = []
   for x in range(10):
       squares.append(x**2)
   print(squares)
   
   # Way 2 : List Comprehension
   squares1 = [x**2 for x in range(10)]
   print(squares1)
   ```

   - 输出结果 :

   ```text
   [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
   [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
   ```

2. 输出 30 以内能够整除 3 的整数

   ```python
   # Way 1 : 传统方法
   numbers = []
   for x in range(30):
       if x % 3 == 0:
           numbers.append(x)
   print(numbers)
   
   # Way 2 : List Comprehension
   multiples = [i for i in range(30) if i % 3 is 0]
   print(multiples)
   ```

   - 输出结果：

   ```text
   [0, 3, 6, 9, 12, 15, 18, 21, 24, 27]
   [0, 3, 6, 9, 12, 15, 18, 21, 24, 27]
   ```

3. 首先获取 30 以内能够整除 3 的整数，然后依次输出所获得整数的平方。

   ```python
   def squared(x):
       return x*x
   
   # Way 1 : Traditional Way
   numbers = []
   for x in range(30):
       if x % 3 == 0:
       	numbers.append(squared(x))
   print(numbers)
   
   # Way 2 : List Comprehension
   multiples = [squared(i) for i in range(30) if i % 3 is 0]
   print(multiples)
   ```

   - 输出结果：

   ```text
   [0, 9, 36, 81, 144, 225, 324, 441, 576, 729]
   [0, 9, 36, 81, 144, 225, 324, 441, 576, 729]
   ```

4. 筛选列表中的数据 :

   ```python
   mylist = [1, 4, -5, 10, -7, 2, 3, -1,0]
   
   # Way 1 : Traditional Way
   # All Positive and Negative Numbers and Zero
   positive_numbers = []
   negative_numbers = []
   for x in mylist:
       if x > 0:
           positive_numbers.append(x)
       else:
           negative_numbers.append(x)
    
   
   # Way 2 : List Comprehension
   # All Positive Numbers
   positive_numbers = [n for n in mylist if n > 0]
   print(positive_numbers)
   
   # All Negative Numbers and Zero
   negative_numbers = [n for n in mylist if n <= 0]
   print(negative_numbers)
   ```

   - 输出结果：

   ```text
   [1, 4, 10, 2, 3]
   [-5, -7, -1, 0]
   ```

### <font color="orange">filter()</font>

在Python程序中，有时候筛选标准无法简单地表示在列表推导式或生成器表达式中.

例子：当筛选过程涉及异常处理或者其他一些复杂的细节时，此时可以考虑将处理筛选功能的代码放到单独的功能函数中，然后使用内建的 **filter()** 函数进行处理.

```python 
def is_int(val):
    try:
        x = int(val)
        return True
    except ValueError:
        return False


values = ['1', '2', '-3', '-', '4', 'N/A', '5']
ivals = list(filter(is_int, values))
print(ivals)
```

- 结果输出：

```text
['1', '2', '-3', '4', '5']
```

*&copy;笔记摘自于 《Python 算法详解 --- 张玲玲》Time ： 2020-8-1*

